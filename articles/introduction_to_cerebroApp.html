<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Introduction to cerebroApp • cerebroApp</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Introduction to cerebroApp">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">cerebroApp</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.2.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/introduction_to_cerebroApp.html">Introduction to cerebroApp</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/romanhaa/cerebroApp">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Introduction to cerebroApp</h1>
                        <h4 class="author">Roman Hillje</h4>
            
            <h4 class="date">07 March, 2020</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/romanhaa/cerebroApp/blob/master/vignettes/introduction_to_cerebroApp.Rmd"><code>vignettes/introduction_to_cerebroApp.Rmd</code></a></small>
      <div class="hidden name"><code>introduction_to_cerebroApp.Rmd</code></div>

    </div>

    
    
<img src="logo_Cerebro.png" alt="Cerebro logo" style="position:absolute; top:0; right:0; padding: 10px; width: 200px;"><div id="introduction" class="section level1">
<h1 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h1>
<p>The <code>cerebroApp</code> package has two main purposes: (1) Give access to the Cerebro user interface, and (2) provide a set of functions to pre-process and export scRNA-seq data for visualization in Cerebro. The Cerebro user interface was built using the Shiny framework and designed to provide numerous perspectives on a given data set that should facilitate data interpretation. This vignette will give you an example of how scRNA-seq data can be processed using the <a href="https://satijalab.org/seurat/">Seurat</a> toolkit and then exported for visualization in Cerebro.</p>
<p>Ket features that can be accessed through Cerebro:</p>
<ul>
<li>Interactive 2D and 3D dimensional reductions.</li>
<li>Sample and cluster overview panels.</li>
<li>Tables of most expressed genes and marker genes for samples and clusters.</li>
<li>Tables of enriched pathways for samples and clusters.</li>
<li>Query gene(s) and gene sets from MSigDB and show their expression in dimensional reductions.</li>
<li>Visualize trajectories calculated with Monocle v2.</li>
<li>All plots can be exported to PNG. In addition, 2D dimensional reductions can be exported to PDF.</li>
<li>Tables can be downloaded in CSV or Excel format.</li>
</ul>
</div>
<div id="installation" class="section level1">
<h1 class="hasAnchor">
<a href="#installation" class="anchor"></a>Installation</h1>
<p>Before starting the workflow, we need to install cerebroApp, as well as the <a href="https://satijalab.org/seurat/">Seurat</a> and <a href="http://cole-trapnell-lab.github.io/monocle-release/">monocle</a> packages, which are not installed as dependencies of cerebroApp because they are only necessary if you want/need to pre-process your scRNA-seq data but not if you just want to launch the Cerebro user interface, e.g. because you already have the pre-processed data.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="cf">if</span> ( <span class="st">'BiocManager'</span> <span class="op">%in%</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/utils/installed.packages.html">installed.packages</a></span>() <span class="op">==</span><span class="st"> </span><span class="ot">FALSE</span> ) <span class="kw"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span>(<span class="st">'BiocManager'</span>)</span>
<span id="cb1-2"><a href="#cb1-2"></a></span>
<span id="cb1-3"><a href="#cb1-3"></a><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(BiocManager)</span>
<span id="cb1-4"><a href="#cb1-4"></a></span>
<span id="cb1-5"><a href="#cb1-5"></a><span class="cf">if</span> ( <span class="st">'cerebroApp'</span> <span class="op">%in%</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/utils/installed.packages.html">installed.packages</a></span>() <span class="op">==</span><span class="st"> </span><span class="ot">FALSE</span> ) <span class="kw"><a href="https://rdrr.io/pkg/BiocManager/man/install.html">install</a></span>(<span class="st">'cerebroApp'</span>)</span>
<span id="cb1-6"><a href="#cb1-6"></a><span class="cf">if</span> ( <span class="st">'Seurat'</span> <span class="op">%in%</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/utils/installed.packages.html">installed.packages</a></span>() <span class="op">==</span><span class="st"> </span><span class="ot">FALSE</span> ) <span class="kw"><a href="https://rdrr.io/pkg/BiocManager/man/install.html">install</a></span>(<span class="st">'Seurat'</span>)</span>
<span id="cb1-7"><a href="#cb1-7"></a><span class="cf">if</span> ( <span class="st">'monocle'</span> <span class="op">%in%</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/utils/installed.packages.html">installed.packages</a></span>() <span class="op">==</span><span class="st"> </span><span class="ot">FALSE</span> ) <span class="kw"><a href="https://rdrr.io/pkg/BiocManager/man/install.html">install</a></span>(<span class="st">'monocle'</span>)</span></code></pre></div>
</div>
<div id="example-of-workflow" class="section level1">
<h1 class="hasAnchor">
<a href="#example-of-workflow" class="anchor"></a>Example of workflow</h1>
<div id="load-packages" class="section level2">
<h2 class="hasAnchor">
<a href="#load-packages" class="anchor"></a>Load packages</h2>
<p>Apart from the packages we just installed, we will also load the dplyr and devtools packages and set a seed to make our analysis reproducible.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(dplyr)</span>
<span id="cb2-2"><a href="#cb2-2"></a><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(Seurat)</span>
<span id="cb2-3"><a href="#cb2-3"></a><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(monocle)</span>
<span id="cb2-4"><a href="#cb2-4"></a><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(cerebroApp)</span>
<span id="cb2-5"><a href="#cb2-5"></a><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(devtools)</span>
<span id="cb2-6"><a href="#cb2-6"></a></span>
<span id="cb2-7"><a href="#cb2-7"></a><span class="kw"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="dv">1234567</span>)</span></code></pre></div>
</div>
<div id="load-count-data" class="section level2">
<h2 class="hasAnchor">
<a href="#load-count-data" class="anchor"></a>Load count data</h2>
<p>In this example workflow, we will load a small transcript count table from the <a href="https://satijalab.org/seurat/">Seurat</a> package containing 80 cells and 230 genes.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a>pbmc &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/utils/read.table.html">read.table</a></span>(</span>
<span id="cb3-2"><a href="#cb3-2"></a>  <span class="dt">file =</span> <span class="kw"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span>(<span class="st">'extdata'</span>, <span class="st">'pbmc_raw.txt'</span>, <span class="dt">package =</span> <span class="st">'Seurat'</span>),</span>
<span id="cb3-3"><a href="#cb3-3"></a>  <span class="dt">as.is =</span> <span class="ot">TRUE</span></span>
<span id="cb3-4"><a href="#cb3-4"></a>)</span></code></pre></div>
</div>
<div id="pre-processing-with-seurat" class="section level2">
<h2 class="hasAnchor">
<a href="#pre-processing-with-seurat" class="anchor"></a>Pre-processing with Seurat</h2>
<p>Now, we create a Seurat object and filter out cells with less than <code>50</code> transcripts or fewer than <code>10</code> expressed genes. Those cut-offs are only reasonable for this example data set and will likely need to be adjusted in a real data set. Then, we follow the <a href="https://satijalab.org/seurat/essential_commands.html">standard Seurat workflow</a>, including…</p>
<ul>
<li>log-normalization of transcript counts,</li>
<li>identification of highly variably genes,</li>
<li>scaling of expression values and regression for the number of transcripts per cell,</li>
<li>principal component analysis (PCA).</li>
</ul>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a>seurat &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/pkg/Seurat/man/CreateSeuratObject.html">CreateSeuratObject</a></span>(</span>
<span id="cb4-2"><a href="#cb4-2"></a>  <span class="dt">project =</span> <span class="st">'pbmc'</span>,</span>
<span id="cb4-3"><a href="#cb4-3"></a>  <span class="dt">counts =</span> pbmc,</span>
<span id="cb4-4"><a href="#cb4-4"></a>  <span class="dt">min.cells =</span> <span class="dv">10</span></span>
<span id="cb4-5"><a href="#cb4-5"></a>)</span>
<span id="cb4-6"><a href="#cb4-6"></a>seurat &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/pkg/Seurat/man/subset.Seurat.html">subset</a></span>(seurat, <span class="dt">subset =</span> nCount_RNA <span class="op">&gt;</span><span class="st"> </span><span class="dv">50</span> <span class="op">&amp;</span><span class="st"> </span>nFeature_RNA <span class="op">&gt;</span><span class="st"> </span><span class="dv">10</span>)</span>
<span id="cb4-7"><a href="#cb4-7"></a>seurat &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/pkg/Seurat/man/NormalizeData.html">NormalizeData</a></span>(seurat, <span class="dt">verbose =</span> <span class="ot">FALSE</span>)</span>
<span id="cb4-8"><a href="#cb4-8"></a>seurat &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/pkg/Seurat/man/FindVariableFeatures.html">FindVariableFeatures</a></span>(seurat, <span class="dt">verbose =</span> <span class="ot">FALSE</span>)</span>
<span id="cb4-9"><a href="#cb4-9"></a>seurat &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/pkg/Seurat/man/ScaleData.html">ScaleData</a></span>(seurat, <span class="dt">vars.to.regress =</span> <span class="st">'nCount_RNA'</span>, <span class="dt">verbose =</span> <span class="ot">FALSE</span>)</span>
<span id="cb4-10"><a href="#cb4-10"></a>seurat &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/pkg/Seurat/man/RunPCA.html">RunPCA</a></span>(seurat, <span class="dt">features =</span> seurat<span class="op">@</span>assays<span class="op">$</span>RNA<span class="op">@</span>var.features, <span class="dt">verbose =</span> <span class="ot">FALSE</span>)</span></code></pre></div>
</div>
<div id="clustering" class="section level2">
<h2 class="hasAnchor">
<a href="#clustering" class="anchor"></a>Clustering</h2>
<p>Then, we identify clusters and build a cluster tree that represents the similarity between clusters.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a>seurat &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/pkg/Seurat/man/FindNeighbors.html">FindNeighbors</a></span>(seurat, <span class="dt">verbose =</span> <span class="ot">FALSE</span>)</span>
<span id="cb5-2"><a href="#cb5-2"></a>seurat &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/pkg/Seurat/man/FindClusters.html">FindClusters</a></span>(seurat, <span class="dt">resolution =</span> <span class="fl">0.5</span>)</span>
<span id="cb5-3"><a href="#cb5-3"></a><span class="co">#&gt; Modularity Optimizer version 1.3.0 by Ludo Waltman and Nees Jan van Eck</span></span>
<span id="cb5-4"><a href="#cb5-4"></a><span class="co">#&gt; </span></span>
<span id="cb5-5"><a href="#cb5-5"></a><span class="co">#&gt; Number of nodes: 77</span></span>
<span id="cb5-6"><a href="#cb5-6"></a><span class="co">#&gt; Number of edges: 2280</span></span>
<span id="cb5-7"><a href="#cb5-7"></a><span class="co">#&gt; </span></span>
<span id="cb5-8"><a href="#cb5-8"></a><span class="co">#&gt; Running Louvain algorithm...</span></span>
<span id="cb5-9"><a href="#cb5-9"></a><span class="co">#&gt; Maximum modularity in 10 random starts: 0.5740</span></span>
<span id="cb5-10"><a href="#cb5-10"></a><span class="co">#&gt; Number of communities: 2</span></span>
<span id="cb5-11"><a href="#cb5-11"></a><span class="co">#&gt; Elapsed time: 0 seconds</span></span>
<span id="cb5-12"><a href="#cb5-12"></a>seurat &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/pkg/Seurat/man/BuildClusterTree.html">BuildClusterTree</a></span>(</span>
<span id="cb5-13"><a href="#cb5-13"></a>  seurat,</span>
<span id="cb5-14"><a href="#cb5-14"></a>  <span class="dt">dims =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">30</span>,</span>
<span id="cb5-15"><a href="#cb5-15"></a>  <span class="dt">reorder =</span> <span class="ot">TRUE</span>,</span>
<span id="cb5-16"><a href="#cb5-16"></a>  <span class="dt">reorder.numeric =</span> <span class="ot">TRUE</span>,</span>
<span id="cb5-17"><a href="#cb5-17"></a>  <span class="dt">verbose =</span> <span class="ot">FALSE</span></span>
<span id="cb5-18"><a href="#cb5-18"></a>)</span></code></pre></div>
</div>
<div id="cell-cycle-analysis" class="section level2">
<h2 class="hasAnchor">
<a href="#cell-cycle-analysis" class="anchor"></a>Cell cycle analysis</h2>
<p>We could also perform cell cycle analysis using the <code><a href="https://rdrr.io/pkg/Seurat/man/CellCycleScoring.html">CellCycleScoring()</a></code> built into Seurat. However, too few of the cell cycle genes are present in this example data set so we will skip it here. The code below should work with a real data set.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a>seurat &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/pkg/Seurat/man/CellCycleScoring.html">CellCycleScoring</a></span>(</span>
<span id="cb6-2"><a href="#cb6-2"></a>  seurat,</span>
<span id="cb6-3"><a href="#cb6-3"></a>  <span class="dt">g2m.features =</span> cc.genes<span class="op">$</span>g2m.genes,</span>
<span id="cb6-4"><a href="#cb6-4"></a>  <span class="dt">s.features =</span> cc.genes<span class="op">$</span>s.genes</span>
<span id="cb6-5"><a href="#cb6-5"></a>)</span>
<span id="cb6-6"><a href="#cb6-6"></a></span>
<span id="cb6-7"><a href="#cb6-7"></a>seurat<span class="op">@</span>misc<span class="op">$</span>gene_lists<span class="op">$</span>G2M_phase_genes &lt;-<span class="st"> </span>cc.genes<span class="op">$</span>g2m.genes</span>
<span id="cb6-8"><a href="#cb6-8"></a>seurat<span class="op">@</span>misc<span class="op">$</span>gene_lists<span class="op">$</span>S_phase_genes &lt;-<span class="st"> </span>cc.genes<span class="op">$</span>s.genes</span></code></pre></div>
</div>
<div id="dimensional-reduction" class="section level2">
<h2 class="hasAnchor">
<a href="#dimensional-reduction" class="anchor"></a>Dimensional reduction</h2>
<p>Next, we use the UMAP technique to generate two- and three-dimensional projections.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a>seurat &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/pkg/Seurat/man/RunUMAP.html">RunUMAP</a></span>(</span>
<span id="cb7-2"><a href="#cb7-2"></a>  seurat,</span>
<span id="cb7-3"><a href="#cb7-3"></a>  <span class="dt">reduction.name =</span> <span class="st">'UMAP'</span>,</span>
<span id="cb7-4"><a href="#cb7-4"></a>  <span class="dt">reduction.key =</span> <span class="st">'UMAP_'</span>,</span>
<span id="cb7-5"><a href="#cb7-5"></a>  <span class="dt">dims =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">30</span>,</span>
<span id="cb7-6"><a href="#cb7-6"></a>  <span class="dt">n.components =</span> <span class="dv">2</span>,</span>
<span id="cb7-7"><a href="#cb7-7"></a>  <span class="dt">seed.use =</span> <span class="dv">100</span>,</span>
<span id="cb7-8"><a href="#cb7-8"></a>  <span class="dt">verbose =</span> <span class="ot">FALSE</span></span>
<span id="cb7-9"><a href="#cb7-9"></a>)</span>
<span id="cb7-10"><a href="#cb7-10"></a></span>
<span id="cb7-11"><a href="#cb7-11"></a>seurat &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/pkg/Seurat/man/RunUMAP.html">RunUMAP</a></span>(</span>
<span id="cb7-12"><a href="#cb7-12"></a>  seurat,</span>
<span id="cb7-13"><a href="#cb7-13"></a>  <span class="dt">reduction.name =</span> <span class="st">'UMAP_3D'</span>,</span>
<span id="cb7-14"><a href="#cb7-14"></a>  <span class="dt">reduction.key =</span> <span class="st">'UMAP3D_'</span>,</span>
<span id="cb7-15"><a href="#cb7-15"></a>  <span class="dt">dims =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">30</span>,</span>
<span id="cb7-16"><a href="#cb7-16"></a>  <span class="dt">n.components =</span> <span class="dv">3</span>,</span>
<span id="cb7-17"><a href="#cb7-17"></a>  <span class="dt">seed.use =</span> <span class="dv">100</span>,</span>
<span id="cb7-18"><a href="#cb7-18"></a>  <span class="dt">verbose =</span> <span class="ot">FALSE</span></span>
<span id="cb7-19"><a href="#cb7-19"></a>)</span></code></pre></div>
</div>
<div id="curate-meta-data" class="section level2">
<h2 class="hasAnchor">
<a href="#curate-meta-data" class="anchor"></a>Curate meta data</h2>
<p>This example data set consists of a single sample so we just add that name to the meta data. Moreover, in order to be able to understand how we did the analysis later, we add some meta data to the <code>misc</code> slot of our Seurat object.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a>seurat<span class="op">@</span>meta.data<span class="op">$</span>sample &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(<span class="st">'pbmc'</span>, <span class="dt">levels =</span> <span class="st">'pbmc'</span>)</span>
<span id="cb8-2"><a href="#cb8-2"></a></span>
<span id="cb8-3"><a href="#cb8-3"></a>seurat<span class="op">@</span>misc<span class="op">$</span>experiment &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(</span>
<span id="cb8-4"><a href="#cb8-4"></a>  <span class="dt">experiment_name =</span> <span class="st">'pbmc'</span>,</span>
<span id="cb8-5"><a href="#cb8-5"></a>  <span class="dt">organism =</span> <span class="st">'hg'</span>,</span>
<span id="cb8-6"><a href="#cb8-6"></a>  <span class="dt">date_of_analysis =</span> <span class="kw"><a href="https://rdrr.io/r/base/Sys.time.html">Sys.Date</a></span>()</span>
<span id="cb8-7"><a href="#cb8-7"></a>)</span>
<span id="cb8-8"><a href="#cb8-8"></a></span>
<span id="cb8-9"><a href="#cb8-9"></a>seurat<span class="op">@</span>misc<span class="op">$</span>parameters &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(</span>
<span id="cb8-10"><a href="#cb8-10"></a>  <span class="dt">gene_nomenclature =</span> <span class="st">'gene_name'</span>,</span>
<span id="cb8-11"><a href="#cb8-11"></a>  <span class="dt">discard_genes_expressed_in_fewer_cells_than =</span> <span class="dv">10</span>,</span>
<span id="cb8-12"><a href="#cb8-12"></a>  <span class="dt">keep_mitochondrial_genes =</span> <span class="ot">TRUE</span>,</span>
<span id="cb8-13"><a href="#cb8-13"></a>  <span class="dt">variables_to_regress_out =</span> <span class="st">'nUMI'</span>,</span>
<span id="cb8-14"><a href="#cb8-14"></a>  <span class="dt">number_PCs =</span> <span class="dv">30</span>,</span>
<span id="cb8-15"><a href="#cb8-15"></a>  <span class="dt">tSNE_perplexity =</span> <span class="dv">30</span>,</span>
<span id="cb8-16"><a href="#cb8-16"></a>  <span class="dt">cluster_resolution =</span> <span class="fl">0.5</span></span>
<span id="cb8-17"><a href="#cb8-17"></a>)</span>
<span id="cb8-18"><a href="#cb8-18"></a></span>
<span id="cb8-19"><a href="#cb8-19"></a>seurat<span class="op">@</span>misc<span class="op">$</span>parameters<span class="op">$</span>filtering &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(</span>
<span id="cb8-20"><a href="#cb8-20"></a>  <span class="dt">UMI_min =</span> <span class="dv">50</span>,</span>
<span id="cb8-21"><a href="#cb8-21"></a>  <span class="dt">UMI_max =</span> <span class="ot">Inf</span>,</span>
<span id="cb8-22"><a href="#cb8-22"></a>  <span class="dt">genes_min =</span> <span class="dv">10</span>,</span>
<span id="cb8-23"><a href="#cb8-23"></a>  <span class="dt">genes_max =</span> <span class="ot">Inf</span></span>
<span id="cb8-24"><a href="#cb8-24"></a>)</span>
<span id="cb8-25"><a href="#cb8-25"></a></span>
<span id="cb8-26"><a href="#cb8-26"></a>seurat<span class="op">@</span>misc<span class="op">$</span>technical_info &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(</span>
<span id="cb8-27"><a href="#cb8-27"></a>  <span class="st">'R'</span> =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/utils/capture.output.html">capture.output</a></span>(<span class="kw"><a href="https://rdrr.io/pkg/devtools/man/reexports.html">session_info</a></span>())</span>
<span id="cb8-28"><a href="#cb8-28"></a>)</span></code></pre></div>
</div>
<div id="cerebroapp-functions-optional-but-recommended" class="section level2">
<h2 class="hasAnchor">
<a href="#cerebroapp-functions-optional-but-recommended" class="anchor"></a>cerebroApp functions (optional but recommended)</h2>
<p>Now we use a set of cerebroApp function to get more information about the data set and the contained samples and clusters.</p>
<div id="calculate-percentage-of-mitochondrial-and-ribosomal-transcripts" class="section level3">
<h3 class="hasAnchor">
<a href="#calculate-percentage-of-mitochondrial-and-ribosomal-transcripts" class="anchor"></a>Calculate percentage of mitochondrial and ribosomal transcripts</h3>
<p>First, for every cell we calculate the percentage of mitochondrial and ribosomal transcripts of all transcripts using the <code><a href="../reference/addPercentMtRibo.html">addPercentMtRibo()</a></code> function.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a>seurat &lt;-<span class="st"> </span><span class="kw"><a href="../reference/addPercentMtRibo.html">addPercentMtRibo</a></span>(</span>
<span id="cb9-2"><a href="#cb9-2"></a>  seurat,</span>
<span id="cb9-3"><a href="#cb9-3"></a>  <span class="dt">organism =</span> <span class="st">'hg'</span>,</span>
<span id="cb9-4"><a href="#cb9-4"></a>  <span class="dt">gene_nomenclature =</span> <span class="st">'name'</span></span>
<span id="cb9-5"><a href="#cb9-5"></a>)</span>
<span id="cb9-6"><a href="#cb9-6"></a><span class="co">#&gt; [15:39:12] No mitochondrial genes found in data set.</span></span>
<span id="cb9-7"><a href="#cb9-7"></a><span class="co">#&gt; [15:39:12] Calculate percentage of 1 ribosomal transcript(s) present in the data set...</span></span></code></pre></div>
</div>
<div id="get-most-expressed-genes" class="section level3">
<h3 class="hasAnchor">
<a href="#get-most-expressed-genes" class="anchor"></a>Get most expressed genes</h3>
<p>Another interesting perspective is to look at the 100 most expressed genes in every sample and cluster. This can help in understanding the transcriptional activity of a given cell population.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a>seurat &lt;-<span class="st"> </span><span class="kw"><a href="../reference/getMostExpressedGenes.html">getMostExpressedGenes</a></span>(</span>
<span id="cb10-2"><a href="#cb10-2"></a>  seurat,</span>
<span id="cb10-3"><a href="#cb10-3"></a>  <span class="dt">column_sample =</span> <span class="st">'sample'</span>,</span>
<span id="cb10-4"><a href="#cb10-4"></a>  <span class="dt">column_cluster =</span> <span class="st">'seurat_clusters'</span></span>
<span id="cb10-5"><a href="#cb10-5"></a>)</span>
<span id="cb10-6"><a href="#cb10-6"></a><span class="co">#&gt; [15:39:12] Get most expressed genes for 1 sample(s)...</span></span>
<span id="cb10-7"><a href="#cb10-7"></a><span class="co">#&gt; [15:39:12] Get most expressed genes for 2 clusters...</span></span></code></pre></div>
</div>
<div id="identify-marker-genes" class="section level3">
<h3 class="hasAnchor">
<a href="#identify-marker-genes" class="anchor"></a>Identify marker genes</h3>
<p>Marker genes are genes which are particularly strongly or weakly expressed in a given cell population, e.g. a sample or cluster. This information can help to distinguish the role of different cell groups in the data set. We can identify marker genes using the <code><a href="../reference/getMarkerGenes.html">getMarkerGenes()</a></code> function which internally uses the <code><a href="https://rdrr.io/pkg/Seurat/man/FindAllMarkers.html">Seurat::FindAllMarkers()</a></code> function but also stores the results in the Seurat object under the <code>@misc</code> slot.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a>seurat &lt;-<span class="st"> </span><span class="kw"><a href="../reference/getMarkerGenes.html">getMarkerGenes</a></span>(</span>
<span id="cb11-2"><a href="#cb11-2"></a>  seurat,</span>
<span id="cb11-3"><a href="#cb11-3"></a>  <span class="dt">organism =</span> <span class="st">'hg'</span>,</span>
<span id="cb11-4"><a href="#cb11-4"></a>  <span class="dt">column_sample =</span> <span class="st">'sample'</span>,</span>
<span id="cb11-5"><a href="#cb11-5"></a>  <span class="dt">column_cluster =</span> <span class="st">'seurat_clusters'</span>,</span>
<span id="cb11-6"><a href="#cb11-6"></a>  <span class="dt">only_pos =</span> <span class="ot">TRUE</span></span>
<span id="cb11-7"><a href="#cb11-7"></a>)</span>
<span id="cb11-8"><a href="#cb11-8"></a><span class="co">#&gt; [15:39:14] Sample column provided but only 1 sample found.</span></span>
<span id="cb11-9"><a href="#cb11-9"></a><span class="co">#&gt; [15:39:14] Get marker genes for 2 clusters...</span></span>
<span id="cb11-10"><a href="#cb11-10"></a><span class="co">#&gt; Calculating cluster 0</span></span>
<span id="cb11-11"><a href="#cb11-11"></a><span class="co">#&gt; Calculating cluster 1</span></span></code></pre></div>
</div>
<div id="perform-pathway-enrichment-on-marker-genes" class="section level3">
<h3 class="hasAnchor">
<a href="#perform-pathway-enrichment-on-marker-genes" class="anchor"></a>Perform pathway enrichment on marker genes</h3>
<p>Using the previously identified marker genes, we can perform a pathway enrichmeny analysis using the <code><a href="../reference/getEnrichedPathways.html">getEnrichedPathways()</a></code> function. The function will internally use the <a href="https://amp.pharm.mssm.edu/Enrichr/">Enrichr</a> API and store the results in the Seurat object under the <code>@misc</code> slot.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a>seurat &lt;-<span class="st"> </span><span class="kw"><a href="../reference/getEnrichedPathways.html">getEnrichedPathways</a></span>(</span>
<span id="cb12-2"><a href="#cb12-2"></a>  seurat,</span>
<span id="cb12-3"><a href="#cb12-3"></a>  <span class="dt">column_sample =</span> <span class="st">'sample'</span>,</span>
<span id="cb12-4"><a href="#cb12-4"></a>  <span class="dt">column_cluster =</span> <span class="st">'seurat_clusters'</span>,</span>
<span id="cb12-5"><a href="#cb12-5"></a>  <span class="dt">adj_p_cutoff =</span> <span class="fl">0.01</span>,</span>
<span id="cb12-6"><a href="#cb12-6"></a>  <span class="dt">max_terms =</span> <span class="dv">100</span></span>
<span id="cb12-7"><a href="#cb12-7"></a>)</span>
<span id="cb12-8"><a href="#cb12-8"></a><span class="co">#&gt; [15:39:14] Skipping pathway enrichment for samples because no marker genes were identified for any sample.</span></span>
<span id="cb12-9"><a href="#cb12-9"></a><span class="co">#&gt; [15:39:14] Get enriched pathway for clusters...</span></span>
<span id="cb12-10"><a href="#cb12-10"></a><span class="co">#&gt; [15:39:21] 16 pathways passed the thresholds across all clusters and databases.</span></span></code></pre></div>
</div>
<div id="gene-set-enrichment" class="section level3">
<h3 class="hasAnchor">
<a href="#gene-set-enrichment" class="anchor"></a>Gene set enrichment</h3>
<p>On top of querying the databases of the <a href="https://amp.pharm.mssm.edu/Enrichr/">Enrichr</a> service, one can also perform gene set enrichment analysis on gene sets provided as a <code>.gmt</code> file, e.g. from the <a href="https://www.gsea-msigdb.org/gsea/msigdb/index.jsp">MSigDB</a>. The <code><a href="../reference/performGeneSetEnrichmentAnalysis.html">performGeneSetEnrichmentAnalysis()</a></code> function uses the <a href="https://bioconductor.org/packages/release/bioc/html/GSVA.html">GSVA</a> method in combination with additional statistics as published by <a href="https://f1000research.com/articles/8-296">Diaz-Mejia et. al.</a>.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a>example_gene_set &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span>(<span class="st">"extdata/example_gene_set.gmt"</span>, <span class="dt">package =</span> <span class="st">"cerebroApp"</span>)</span>
<span id="cb13-2"><a href="#cb13-2"></a></span>
<span id="cb13-3"><a href="#cb13-3"></a>seurat &lt;-<span class="st"> </span><span class="kw"><a href="../reference/performGeneSetEnrichmentAnalysis.html">performGeneSetEnrichmentAnalysis</a></span>(</span>
<span id="cb13-4"><a href="#cb13-4"></a>  seurat,</span>
<span id="cb13-5"><a href="#cb13-5"></a>  <span class="dt">GMT_file =</span> example_gene_set,</span>
<span id="cb13-6"><a href="#cb13-6"></a>  <span class="dt">column_sample =</span> <span class="st">'sample'</span>,</span>
<span id="cb13-7"><a href="#cb13-7"></a>  <span class="dt">column_cluster =</span> <span class="st">'seurat_clusters'</span>,</span>
<span id="cb13-8"><a href="#cb13-8"></a>  <span class="dt">thresh_p_val =</span> <span class="fl">0.05</span>,</span>
<span id="cb13-9"><a href="#cb13-9"></a>  <span class="dt">thresh_q_val =</span> <span class="fl">0.1</span>,</span>
<span id="cb13-10"><a href="#cb13-10"></a>  <span class="dt">parallel.sz =</span> <span class="dv">1</span>,</span>
<span id="cb13-11"><a href="#cb13-11"></a>  <span class="dt">verbose =</span> <span class="ot">FALSE</span></span>
<span id="cb13-12"><a href="#cb13-12"></a>)</span></code></pre></div>
</div>
</div>
<div id="trajectory-analysis-with-monocle-optional" class="section level2">
<h2 class="hasAnchor">
<a href="#trajectory-analysis-with-monocle-optional" class="anchor"></a>Trajectory analysis with Monocle (optional)</h2>
<p>Then, we perform trajectory analysis with <a href="http://cole-trapnell-lab.github.io/monocle-release/">Monocle v2</a> using the previously identified highly variable genes. We extract the trajectory from the generated Monocle object with the <code><a href="../reference/extractMonocleTrajectory.html">extractMonocleTrajectory()</a></code> function of cerebroApp and attach it to our Seurat object.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a>monocle &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/pkg/monocle/man/newCellDataSet.html">newCellDataSet</a></span>(</span>
<span id="cb14-2"><a href="#cb14-2"></a>  seurat<span class="op">@</span>assays<span class="op">$</span>RNA<span class="op">@</span>data,</span>
<span id="cb14-3"><a href="#cb14-3"></a>  <span class="dt">phenoData =</span> <span class="kw">new</span>(<span class="st">'AnnotatedDataFrame'</span>, <span class="dt">data =</span> seurat<span class="op">@</span>meta.data),</span>
<span id="cb14-4"><a href="#cb14-4"></a>  <span class="dt">featureData =</span> <span class="kw">new</span>(<span class="st">'AnnotatedDataFrame'</span>, <span class="dt">data =</span> <span class="kw"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(</span>
<span id="cb14-5"><a href="#cb14-5"></a>    <span class="dt">gene_short_name =</span> <span class="kw"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(seurat<span class="op">@</span>assays<span class="op">$</span>RNA<span class="op">@</span>data),</span>
<span id="cb14-6"><a href="#cb14-6"></a>    <span class="dt">row.names =</span> <span class="kw"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(seurat<span class="op">@</span>assays<span class="op">$</span>RNA<span class="op">@</span>data))</span>
<span id="cb14-7"><a href="#cb14-7"></a>  )</span>
<span id="cb14-8"><a href="#cb14-8"></a>)</span>
<span id="cb14-9"><a href="#cb14-9"></a></span>
<span id="cb14-10"><a href="#cb14-10"></a>monocle &lt;-<span class="st"> </span><span class="kw">estimateSizeFactors</span>(monocle)</span>
<span id="cb14-11"><a href="#cb14-11"></a>monocle &lt;-<span class="st"> </span><span class="kw">estimateDispersions</span>(monocle)</span>
<span id="cb14-12"><a href="#cb14-12"></a><span class="co">#&gt; Removing 9 outliers</span></span>
<span id="cb14-13"><a href="#cb14-13"></a>monocle &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/pkg/monocle/man/setOrderingFilter.html">setOrderingFilter</a></span>(monocle, seurat<span class="op">@</span>assays<span class="op">$</span>RNA<span class="op">@</span>var.features)</span>
<span id="cb14-14"><a href="#cb14-14"></a>monocle &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/pkg/monocle/man/reduceDimension.html">reduceDimension</a></span>(monocle, <span class="dt">max_components =</span> <span class="dv">2</span>, <span class="dt">method =</span> <span class="st">'DDRTree'</span>)</span>
<span id="cb14-15"><a href="#cb14-15"></a>monocle &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/pkg/monocle/man/orderCells.html">orderCells</a></span>(monocle)</span>
<span id="cb14-16"><a href="#cb14-16"></a></span>
<span id="cb14-17"><a href="#cb14-17"></a>seurat &lt;-<span class="st"> </span><span class="kw"><a href="../reference/extractMonocleTrajectory.html">extractMonocleTrajectory</a></span>(monocle, seurat, <span class="st">'highly_variable_genes'</span>)</span></code></pre></div>
</div>
<div id="export-to-cerebro-format" class="section level2">
<h2 class="hasAnchor">
<a href="#export-to-cerebro-format" class="anchor"></a>Export to Cerebro format</h2>
<p>Finally, we use the <code><a href="../reference/exportFromSeurat.html">exportFromSeurat()</a></code> function of cerebroApp to export our Seurat object to a <code>.crb</code> file which can be loaded into Cerebro.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a><span class="kw"><a href="../reference/exportFromSeurat.html">exportFromSeurat</a></span>(</span>
<span id="cb15-2"><a href="#cb15-2"></a>  seurat,</span>
<span id="cb15-3"><a href="#cb15-3"></a>  <span class="dt">experiment_name =</span> <span class="st">'pbmc'</span>,</span>
<span id="cb15-4"><a href="#cb15-4"></a>  <span class="dt">file =</span> <span class="kw"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="st">'cerebro_pbmc_'</span>, <span class="kw"><a href="https://rdrr.io/r/base/Sys.time.html">Sys.Date</a></span>(), <span class="st">'.crb'</span>),</span>
<span id="cb15-5"><a href="#cb15-5"></a>  <span class="dt">organism =</span> <span class="st">'hg'</span>,</span>
<span id="cb15-6"><a href="#cb15-6"></a>  <span class="dt">column_cluster =</span> <span class="st">'seurat_clusters'</span>,</span>
<span id="cb15-7"><a href="#cb15-7"></a>  <span class="dt">column_nUMI =</span> <span class="st">'nCount_RNA'</span>,</span>
<span id="cb15-8"><a href="#cb15-8"></a>  <span class="dt">column_nGene =</span> <span class="st">'nFeature_RNA'</span></span>
<span id="cb15-9"><a href="#cb15-9"></a>)</span>
<span id="cb15-10"><a href="#cb15-10"></a><span class="co">#&gt; [15:39:23] Initializing Cerebro object...</span></span>
<span id="cb15-11"><a href="#cb15-11"></a><span class="co">#&gt; [15:39:23] Collecting available meta data...</span></span>
<span id="cb15-12"><a href="#cb15-12"></a><span class="co">#&gt; [15:39:23] Extracting all meta data columns...</span></span>
<span id="cb15-13"><a href="#cb15-13"></a><span class="co">#&gt; [15:39:23] Extracting tables of most expressed genes...</span></span>
<span id="cb15-14"><a href="#cb15-14"></a><span class="co">#&gt; [15:39:23] Extracting tables of marker genes...</span></span>
<span id="cb15-15"><a href="#cb15-15"></a><span class="co">#&gt; [15:39:23] Extracting pathway enrichment results...</span></span>
<span id="cb15-16"><a href="#cb15-16"></a><span class="co">#&gt; [15:39:23] Extracting dimensional reductions...</span></span>
<span id="cb15-17"><a href="#cb15-17"></a><span class="co">#&gt; [15:39:23] Will export the following dimensional reductions: UMAP, UMAP_3D</span></span>
<span id="cb15-18"><a href="#cb15-18"></a><span class="co">#&gt; [15:39:23] Will export the following trajectories: highly_variable_genes</span></span>
<span id="cb15-19"><a href="#cb15-19"></a><span class="co">#&gt; [15:39:23] Extracting cluster tree...</span></span>
<span id="cb15-20"><a href="#cb15-20"></a><span class="co">#&gt; [15:39:23] Extracting log-normalized expression data...</span></span>
<span id="cb15-21"><a href="#cb15-21"></a><span class="co">#&gt; [15:39:23] Saving Cerebro file...</span></span></code></pre></div>
<p>The Cerebro use interface can be launched using the <code><a href="../reference/launchCerebro.html">launchCerebro()</a></code> function.</p>
</div>
</div>
<div id="other-example-data-sets" class="section level1">
<h1 class="hasAnchor">
<a href="#other-example-data-sets" class="anchor"></a>Other example data sets</h1>
<p>We provide ready-to-load <code>.crb</code> files for a set of real data sets processed using either <a href="https://icb-scanpy.readthedocs-hosted.com/en/stable/">scanpy</a> and <a href="https://satijalab.org/seurat/">Seurat (v2.x and v3.x)</a> on our GitHub repository: <a href="https://github.com/romanhaa/Cerebro/tree/master/examples" class="uri">https://github.com/romanhaa/Cerebro/tree/master/examples</a></p>
</div>
<div id="session-info" class="section level1">
<h1 class="hasAnchor">
<a href="#session-info" class="anchor"></a>Session info</h1>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1"></a><span class="kw"><a href="https://rdrr.io/r/utils/sessionInfo.html">sessionInfo</a></span>()</span>
<span id="cb16-2"><a href="#cb16-2"></a><span class="co">#&gt; R version 3.5.3 (2019-03-11)</span></span>
<span id="cb16-3"><a href="#cb16-3"></a><span class="co">#&gt; Platform: x86_64-apple-darwin15.6.0 (64-bit)</span></span>
<span id="cb16-4"><a href="#cb16-4"></a><span class="co">#&gt; Running under: macOS  10.15.3</span></span>
<span id="cb16-5"><a href="#cb16-5"></a><span class="co">#&gt; </span></span>
<span id="cb16-6"><a href="#cb16-6"></a><span class="co">#&gt; Matrix products: default</span></span>
<span id="cb16-7"><a href="#cb16-7"></a><span class="co">#&gt; BLAS: /Library/Frameworks/R.framework/Versions/3.5/Resources/lib/libRblas.0.dylib</span></span>
<span id="cb16-8"><a href="#cb16-8"></a><span class="co">#&gt; LAPACK: /Library/Frameworks/R.framework/Versions/3.5/Resources/lib/libRlapack.dylib</span></span>
<span id="cb16-9"><a href="#cb16-9"></a><span class="co">#&gt; </span></span>
<span id="cb16-10"><a href="#cb16-10"></a><span class="co">#&gt; locale:</span></span>
<span id="cb16-11"><a href="#cb16-11"></a><span class="co">#&gt; [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8</span></span>
<span id="cb16-12"><a href="#cb16-12"></a><span class="co">#&gt; </span></span>
<span id="cb16-13"><a href="#cb16-13"></a><span class="co">#&gt; attached base packages:</span></span>
<span id="cb16-14"><a href="#cb16-14"></a><span class="co">#&gt;  [1] splines   stats4    parallel  stats     graphics  grDevices utils    </span></span>
<span id="cb16-15"><a href="#cb16-15"></a><span class="co">#&gt;  [8] datasets  methods   base     </span></span>
<span id="cb16-16"><a href="#cb16-16"></a><span class="co">#&gt; </span></span>
<span id="cb16-17"><a href="#cb16-17"></a><span class="co">#&gt; other attached packages:</span></span>
<span id="cb16-18"><a href="#cb16-18"></a><span class="co">#&gt;  [1] devtools_2.2.1      usethis_1.5.1       cerebroApp_1.2.1   </span></span>
<span id="cb16-19"><a href="#cb16-19"></a><span class="co">#&gt;  [4] monocle_2.10.1      DDRTree_0.1.5       irlba_2.3.3        </span></span>
<span id="cb16-20"><a href="#cb16-20"></a><span class="co">#&gt;  [7] VGAM_1.1-2          ggplot2_3.2.1       Biobase_2.42.0     </span></span>
<span id="cb16-21"><a href="#cb16-21"></a><span class="co">#&gt; [10] BiocGenerics_0.28.0 Matrix_1.2-18       Seurat_3.1.2       </span></span>
<span id="cb16-22"><a href="#cb16-22"></a><span class="co">#&gt; [13] dplyr_0.8.4         BiocManager_1.30.10</span></span>
<span id="cb16-23"><a href="#cb16-23"></a><span class="co">#&gt; </span></span>
<span id="cb16-24"><a href="#cb16-24"></a><span class="co">#&gt; loaded via a namespace (and not attached):</span></span>
<span id="cb16-25"><a href="#cb16-25"></a><span class="co">#&gt;   [1] shinydashboard_0.7.1 reticulate_1.14      R.utils_2.9.2       </span></span>
<span id="cb16-26"><a href="#cb16-26"></a><span class="co">#&gt;   [4] tidyselect_1.0.0     RSQLite_2.2.0        AnnotationDbi_1.44.0</span></span>
<span id="cb16-27"><a href="#cb16-27"></a><span class="co">#&gt;   [7] htmlwidgets_1.5.1    grid_3.5.3           combinat_0.0-8      </span></span>
<span id="cb16-28"><a href="#cb16-28"></a><span class="co">#&gt;  [10] docopt_0.6.1         Rtsne_0.15           munsell_0.5.0       </span></span>
<span id="cb16-29"><a href="#cb16-29"></a><span class="co">#&gt;  [13] codetools_0.2-16     mutoss_0.1-12        ica_1.0-2           </span></span>
<span id="cb16-30"><a href="#cb16-30"></a><span class="co">#&gt;  [16] DT_0.12              future_1.16.0        miniUI_0.1.1.1      </span></span>
<span id="cb16-31"><a href="#cb16-31"></a><span class="co">#&gt;  [19] withr_2.1.2          colorspace_1.4-1     fastICA_1.2-2       </span></span>
<span id="cb16-32"><a href="#cb16-32"></a><span class="co">#&gt;  [22] knitr_1.27           ROCR_1.0-7           shinyWidgets_0.5.0  </span></span>
<span id="cb16-33"><a href="#cb16-33"></a><span class="co">#&gt;  [25] gbRd_0.4-11          listenv_0.8.0        Rdpack_0.11-1       </span></span>
<span id="cb16-34"><a href="#cb16-34"></a><span class="co">#&gt;  [28] slam_0.1-47          mnormt_1.5-6         bit64_0.9-7         </span></span>
<span id="cb16-35"><a href="#cb16-35"></a><span class="co">#&gt;  [31] pheatmap_1.0.12      rprojroot_1.3-2      treeio_1.6.2        </span></span>
<span id="cb16-36"><a href="#cb16-36"></a><span class="co">#&gt;  [34] vctrs_0.2.2          TH.data_1.0-10       xfun_0.12           </span></span>
<span id="cb16-37"><a href="#cb16-37"></a><span class="co">#&gt;  [37] R6_2.4.1             rsvd_1.0.2           msigdbr_7.0.1       </span></span>
<span id="cb16-38"><a href="#cb16-38"></a><span class="co">#&gt;  [40] bitops_1.0-6         assertthat_0.2.1     promises_1.1.0      </span></span>
<span id="cb16-39"><a href="#cb16-39"></a><span class="co">#&gt;  [43] SDMTools_1.1-221.2   scales_1.1.0         multcomp_1.4-12     </span></span>
<span id="cb16-40"><a href="#cb16-40"></a><span class="co">#&gt;  [46] gtable_0.3.0         npsurv_0.4-0         globals_0.12.5      </span></span>
<span id="cb16-41"><a href="#cb16-41"></a><span class="co">#&gt;  [49] processx_3.4.1       sandwich_2.5-1       rlang_0.4.4         </span></span>
<span id="cb16-42"><a href="#cb16-42"></a><span class="co">#&gt;  [52] lazyeval_0.2.2       formattable_0.2.0.1  yaml_2.2.1          </span></span>
<span id="cb16-43"><a href="#cb16-43"></a><span class="co">#&gt;  [55] reshape2_1.4.3       backports_1.1.5      httpuv_1.5.2        </span></span>
<span id="cb16-44"><a href="#cb16-44"></a><span class="co">#&gt;  [58] qvalue_2.14.1        tools_3.5.3          ellipsis_0.3.0      </span></span>
<span id="cb16-45"><a href="#cb16-45"></a><span class="co">#&gt;  [61] gplots_3.0.1.2       RColorBrewer_1.1-2   proxy_0.4-23        </span></span>
<span id="cb16-46"><a href="#cb16-46"></a><span class="co">#&gt;  [64] sessioninfo_1.1.1    ggridges_0.5.2       TFisher_0.2.0       </span></span>
<span id="cb16-47"><a href="#cb16-47"></a><span class="co">#&gt;  [67] Rcpp_1.0.3           plyr_1.8.5           progress_1.2.2      </span></span>
<span id="cb16-48"><a href="#cb16-48"></a><span class="co">#&gt;  [70] purrr_0.3.3          RCurl_1.98-1.1       densityClust_0.3    </span></span>
<span id="cb16-49"><a href="#cb16-49"></a><span class="co">#&gt;  [73] prettyunits_1.1.1    ps_1.3.0             pbapply_1.4-2       </span></span>
<span id="cb16-50"><a href="#cb16-50"></a><span class="co">#&gt;  [76] viridis_0.5.1        cowplot_1.0.0        S4Vectors_0.20.1    </span></span>
<span id="cb16-51"><a href="#cb16-51"></a><span class="co">#&gt;  [79] zoo_1.8-7            ggrepel_0.8.1        cluster_2.1.0       </span></span>
<span id="cb16-52"><a href="#cb16-52"></a><span class="co">#&gt;  [82] fs_1.3.1             magrittr_1.5         RSpectra_0.16-0     </span></span>
<span id="cb16-53"><a href="#cb16-53"></a><span class="co">#&gt;  [85] data.table_1.12.8    colourpicker_1.0     lmtest_0.9-37       </span></span>
<span id="cb16-54"><a href="#cb16-54"></a><span class="co">#&gt;  [88] RANN_2.6.1           mvtnorm_1.0-12       fitdistrplus_1.0-14 </span></span>
<span id="cb16-55"><a href="#cb16-55"></a><span class="co">#&gt;  [91] matrixStats_0.55.0   pkgload_1.0.2        hms_0.5.3           </span></span>
<span id="cb16-56"><a href="#cb16-56"></a><span class="co">#&gt;  [94] lsei_1.2-0           mime_0.8             evaluate_0.14       </span></span>
<span id="cb16-57"><a href="#cb16-57"></a><span class="co">#&gt;  [97] GSVA_1.30.0          xtable_1.8-4         XML_3.99-0.3        </span></span>
<span id="cb16-58"><a href="#cb16-58"></a><span class="co">#&gt; [100] sparsesvd_0.2        IRanges_2.16.0       gridExtra_2.3       </span></span>
<span id="cb16-59"><a href="#cb16-59"></a><span class="co">#&gt; [103] biomaRt_2.38.0       testthat_2.3.1       HSMMSingleCell_1.2.0</span></span>
<span id="cb16-60"><a href="#cb16-60"></a><span class="co">#&gt; [106] compiler_3.5.3       tibble_2.1.3         KernSmooth_2.23-16  </span></span>
<span id="cb16-61"><a href="#cb16-61"></a><span class="co">#&gt; [109] crayon_1.3.4         R.oo_1.23.0          htmltools_0.4.0     </span></span>
<span id="cb16-62"><a href="#cb16-62"></a><span class="co">#&gt; [112] later_1.0.0          tidyr_1.0.2          geneplotter_1.60.0  </span></span>
<span id="cb16-63"><a href="#cb16-63"></a><span class="co">#&gt; [115] RcppParallel_4.4.4   DBI_1.1.0            MASS_7.3-51.5       </span></span>
<span id="cb16-64"><a href="#cb16-64"></a><span class="co">#&gt; [118] readr_1.3.1          cli_2.0.1            R.methodsS3_1.7.1   </span></span>
<span id="cb16-65"><a href="#cb16-65"></a><span class="co">#&gt; [121] gdata_2.18.0         metap_1.3            igraph_1.2.4.2      </span></span>
<span id="cb16-66"><a href="#cb16-66"></a><span class="co">#&gt; [124] pkgconfig_2.0.3      pkgdown_1.4.1        sn_1.5-5            </span></span>
<span id="cb16-67"><a href="#cb16-67"></a><span class="co">#&gt; [127] rvcheck_0.1.7        numDeriv_2016.8-1.1  plotly_4.9.1        </span></span>
<span id="cb16-68"><a href="#cb16-68"></a><span class="co">#&gt; [130] ggtree_1.14.6        annotate_1.60.1      multtest_2.38.0     </span></span>
<span id="cb16-69"><a href="#cb16-69"></a><span class="co">#&gt; [133] bibtex_0.4.2.2       callr_3.4.1          stringr_1.4.0       </span></span>
<span id="cb16-70"><a href="#cb16-70"></a><span class="co">#&gt; [136] digest_0.6.23        sctransform_0.2.1    RcppAnnoy_0.0.14    </span></span>
<span id="cb16-71"><a href="#cb16-71"></a><span class="co">#&gt; [139] tsne_0.1-3           graph_1.60.0         rmarkdown_2.1       </span></span>
<span id="cb16-72"><a href="#cb16-72"></a><span class="co">#&gt; [142] leiden_0.3.3         tidytree_0.3.1       uwot_0.1.5          </span></span>
<span id="cb16-73"><a href="#cb16-73"></a><span class="co">#&gt; [145] GSEABase_1.44.0      curl_4.3             shiny_1.4.0         </span></span>
<span id="cb16-74"><a href="#cb16-74"></a><span class="co">#&gt; [148] gtools_3.8.1         lifecycle_0.2.0      nlme_3.1-143        </span></span>
<span id="cb16-75"><a href="#cb16-75"></a><span class="co">#&gt; [151] jsonlite_1.6.1       fansi_0.4.1          desc_1.2.0          </span></span>
<span id="cb16-76"><a href="#cb16-76"></a><span class="co">#&gt; [154] viridisLite_0.3.0    limma_3.38.3         pillar_1.4.3        </span></span>
<span id="cb16-77"><a href="#cb16-77"></a><span class="co">#&gt; [157] lattice_0.20-38      pkgbuild_1.0.6       fastmap_1.0.1       </span></span>
<span id="cb16-78"><a href="#cb16-78"></a><span class="co">#&gt; [160] httr_1.4.1           plotrix_3.7-7        survival_3.1-8      </span></span>
<span id="cb16-79"><a href="#cb16-79"></a><span class="co">#&gt; [163] remotes_2.1.0        glue_1.3.1           qlcMatrix_0.9.7     </span></span>
<span id="cb16-80"><a href="#cb16-80"></a><span class="co">#&gt; [166] FNN_1.1.3            png_0.1-7            shinythemes_1.1.2   </span></span>
<span id="cb16-81"><a href="#cb16-81"></a><span class="co">#&gt; [169] bit_1.1-15.1         stringi_1.4.5        blob_1.2.1          </span></span>
<span id="cb16-82"><a href="#cb16-82"></a><span class="co">#&gt; [172] caTools_1.17.1.4     memoise_1.1.0        future.apply_1.4.0  </span></span>
<span id="cb16-83"><a href="#cb16-83"></a><span class="co">#&gt; [175] ape_5.3</span></span></code></pre></div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">

        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#introduction">Introduction</a></li>
      <li><a href="#installation">Installation</a></li>
      <li>
<a href="#example-of-workflow">Example of workflow</a><ul class="nav nav-pills nav-stacked">
<li><a href="#load-packages">Load packages</a></li>
      <li><a href="#load-count-data">Load count data</a></li>
      <li><a href="#pre-processing-with-seurat">Pre-processing with Seurat</a></li>
      <li><a href="#clustering">Clustering</a></li>
      <li><a href="#cell-cycle-analysis">Cell cycle analysis</a></li>
      <li><a href="#dimensional-reduction">Dimensional reduction</a></li>
      <li><a href="#curate-meta-data">Curate meta data</a></li>
      <li><a href="#cerebroapp-functions-optional-but-recommended">cerebroApp functions (optional but recommended)</a></li>
      <li><a href="#trajectory-analysis-with-monocle-optional">Trajectory analysis with Monocle (optional)</a></li>
      <li><a href="#export-to-cerebro-format">Export to Cerebro format</a></li>
      </ul>
</li>
      <li><a href="#other-example-data-sets">Other example data sets</a></li>
      <li><a href="#session-info">Session info</a></li>
      </ul>
</div>
      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by Roman Hillje.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
