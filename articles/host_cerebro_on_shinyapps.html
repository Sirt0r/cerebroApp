<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Host Cerebro on shinyapps.io • cerebroApp</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Host Cerebro on shinyapps.io">
<meta property="og:description" content="cerebroApp">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">cerebroApp</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.3.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/cerebroApp_workflow_Seurat.html">The cerebroApp workflow (Seurat)</a>
    </li>
    <li class="dropdown-submenu">
      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">The Cerebro interface</a>
      <ul class="dropdown-menu" role="menu">
<li>
          <a href="../articles/Cerebro_interface_v1.2.html">Cerebro v1.2 and older</a>
        </li>
      </ul>
</li>
    <li>
      <a href="../articles/export_a_data_set_in_SCE_format.html">Export an SCE/SingleCellExperiment object</a>
    </li>
    <li>
      <a href="../articles/export_and_visualize_custom_tables_and_plots.html">Export and visualize custom tables and plots</a>
    </li>
    <li>
      <a href="../articles/launch_cerebro_with_pre-loaded_data_set.html">Launch Cerebro with pre-loaded data set</a>
    </li>
    <li>
      <a href="../articles/host_cerebro_on_shinyapps.html">Host Cerebro on shinyapps.io</a>
    </li>
    <li>
      <a href="../articles/control_access_to_cerebro_with_a_login_page.html">Control access to Cerebro with a login page</a>
    </li>
    <li>
      <a href="../articles/overview_of_cerebro_v1.3_class.html">Overview of the Cerebro v1.3 class</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Release notes
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/release_notes_v1.3.html">v1.3</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/romanhaa/cerebroApp/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="https://twitter.com/fakechek1">
    <span class="fab fa fab fa-twitter fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="host_cerebro_on_shinyapps_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Host Cerebro on shinyapps.io</h1>
                        <h4 class="author">Roman Hillje</h4>
            
            <h4 class="date">18 October, 2020</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/romanhaa/cerebroApp/blob/master/vignettes/host_cerebro_on_shinyapps.Rmd"><code>vignettes/host_cerebro_on_shinyapps.Rmd</code></a></small>
      <div class="hidden name"><code>host_cerebro_on_shinyapps.Rmd</code></div>

    </div>

    
    
<div id="overview" class="section level1">
<h1 class="hasAnchor">
<a href="#overview" class="anchor"></a>Overview</h1>
<p>In this vignette, I explain how one can host Cerebro on <a href="https://www.shinyapps.io">shinyapps.io</a>. For a more detailed tutorial on how to host Shiny apps on shinyapps.io, take a look here: <a href="https://shiny.rstudio.com/articles/shinyapps.html" class="uri">https://shiny.rstudio.com/articles/shinyapps.html</a></p>
<p><a href="https://www.shinyapps.io">shinyapps.io</a> is a great place to host Shiny apps and make them accessible for other users. You will need an account on the website. The free account comes with a limit on (1) the number of applications that can be hosted in parallel and (2) the number of active hours, but it is enough to get some experience and figure out if this service fits your purpose.</p>
</div>
<div id="setup" class="section level1">
<h1 class="hasAnchor">
<a href="#setup" class="anchor"></a>Setup</h1>
<p>To upload Cerebro to shinyapps.io, we will use the <a href="https://cran.r-project.org/web/packages/rsconnect/index.html"><code>rsconnect</code></a> package, therefore it needs to be installed first. Of course, we also need the cerebroApp package.</p>
<div class="sourceCode" id="cb1"><html><body><pre class="r"><span class="kw">if</span> ( <span class="st">'rsconnect'</span> <span class="kw">%in%</span> <span class="fu"><a href="https://rdrr.io/r/utils/installed.packages.html">installed.packages</a></span>() <span class="kw">==</span> <span class="fl">FALSE</span> ) <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span>(<span class="st">'rsconnect'</span>)
<span class="kw">if</span> ( <span class="st">'cerebroApp'</span> <span class="kw">%in%</span> <span class="fu"><a href="https://rdrr.io/r/utils/installed.packages.html">installed.packages</a></span>() <span class="kw">==</span> <span class="fl">FALSE</span> ) <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span>(<span class="st">'cerebroApp'</span>)

<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">rsconnect</span>)</pre></body></html></div>
<p>Then, you need to provide <code>rsconnect</code> with your shinyapps.io account info. On the shinyapps.io website, in the left navigation bar, go to “Account” and then “Tokens”. A token should have already been generated for you. Take the token and secret, your account name, and run the command below.</p>
<div class="sourceCode" id="cb2"><html><body><pre class="r"><span class="kw pkg">rsconnect</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/rsconnect/man/setAccountInfo.html">setAccountInfo</a></span>(<span class="kw">name</span><span class="kw">=</span><span class="st">"&lt;ACCOUNT&gt;"</span>, <span class="kw">token</span><span class="kw">=</span><span class="st">"&lt;TOKEN&gt;"</span>, <span class="kw">secret</span><span class="kw">=</span><span class="st">"&lt;SECRET&gt;"</span>)</pre></body></html></div>
</div>
<div id="prepare-shiny-files" class="section level1">
<h1 class="hasAnchor">
<a href="#prepare-shiny-files" class="anchor"></a>Prepare Shiny files</h1>
<p>Next, we need to copy the Shiny files and some other data for Cerebro v1.3 to a dedicated directory, here <code>~/test_cerebro_shinyapps</code>. If you prefer to host a different version of Cerebro, adapt the code accordingly.</p>
<div class="sourceCode" id="cb3"><html><body><pre class="r"><span class="no">app_directory</span> <span class="kw">&lt;-</span> <span class="st">'~/test_cerebro_shinyapps'</span>

<span class="fu"><a href="https://rdrr.io/r/base/files2.html">dir.create</a></span>(<span class="no">app_directory</span>)
<span class="fu"><a href="https://rdrr.io/r/base/files2.html">dir.create</a></span>(<span class="kw pkg">glue</span><span class="kw ns">::</span><span class="fu"><a href="https://glue.tidyverse.org/reference/glue.html">glue</a></span>(<span class="st">'{app_directory}/shiny'</span>))

<span class="fu"><a href="https://rdrr.io/r/base/files.html">file.copy</a></span>(
  <span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span>(<span class="st">'extdata'</span>, <span class="kw">package</span> <span class="kw">=</span> <span class="st">'cerebroApp'</span>),
  <span class="no">app_directory</span>,
  <span class="kw">recursive</span> <span class="kw">=</span> <span class="fl">TRUE</span>
)

<span class="fu"><a href="https://rdrr.io/r/base/unlink.html">unlink</a></span>(
  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="kw pkg">glue</span><span class="kw ns">::</span><span class="fu"><a href="https://glue.tidyverse.org/reference/glue.html">glue</a></span>(<span class="st">'{app_directory}/extdata/v1.0'</span>),
    <span class="kw pkg">glue</span><span class="kw ns">::</span><span class="fu"><a href="https://glue.tidyverse.org/reference/glue.html">glue</a></span>(<span class="st">'{app_directory}/extdata/v1.1'</span>),
    <span class="kw pkg">glue</span><span class="kw ns">::</span><span class="fu"><a href="https://glue.tidyverse.org/reference/glue.html">glue</a></span>(<span class="st">'{app_directory}/extdata/v1.2'</span>)),
  <span class="kw">recursive</span> <span class="kw">=</span> <span class="fl">TRUE</span>
)

<span class="fu"><a href="https://rdrr.io/r/base/files.html">file.copy</a></span>(
  <span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span>(<span class="st">'shiny'</span>, <span class="st">'v1.3'</span>, <span class="kw">package</span> <span class="kw">=</span> <span class="st">'cerebroApp'</span>),
  <span class="kw pkg">glue</span><span class="kw ns">::</span><span class="fu"><a href="https://glue.tidyverse.org/reference/glue.html">glue</a></span>(<span class="st">'{app_directory}/shiny'</span>),
  <span class="kw">recursive</span> <span class="kw">=</span> <span class="fl">TRUE</span>
)</pre></body></html></div>
</div>
<div id="prepare-app-r-file" class="section level1">
<h1 class="hasAnchor">
<a href="#prepare-app-r-file" class="anchor"></a>Prepare <code>app.R</code> file</h1>
<p>Since we are not using the usual <code><a href="../reference/launchCerebro.html">launchCerebro()</a></code> function to start Cerebro, we have to prepare a dedicated <code>app.R</code> file that will do the same for us. Use your favorite text editor to open a new file, paste the code below into it, and save it as <code>~/test_cerebro_shinyapps/app.R</code>.</p>
<div class="sourceCode" id="cb4"><html><body><pre class="r"><span class="co">## load packages -------------------------------------------------------------##</span>
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">dplyr</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">DT</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">plotly</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">shiny</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">shinydashboard</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">shinyWidgets</span>)

<span class="co">## set parameters ------------------------------------------------------------##</span>
<span class="no">Cerebro.options</span> <span class="kw">&lt;&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(
  <span class="st">"mode"</span> <span class="kw">=</span> <span class="st">"open"</span>,
  <span class="st">"crb_file_to_load"</span> <span class="kw">=</span> <span class="st">"extdata/v1.3/example.crb"</span>,
  <span class="st">"cerebro_root"</span> <span class="kw">=</span> <span class="st">"."</span>
)

<span class="no">shiny_options</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(
  <span class="kw">maxRequestSize</span> <span class="kw">=</span> <span class="fl">800</span> * <span class="fl">1024</span>^<span class="fl">2</span>,
  <span class="kw">port</span> <span class="kw">=</span> <span class="fl">1337</span>
)

<span class="co">## load server and UI functions ----------------------------------------------##</span>
<span class="fu"><a href="https://rdrr.io/r/base/source.html">source</a></span>(<span class="kw pkg">glue</span><span class="kw ns">::</span><span class="fu"><a href="https://glue.tidyverse.org/reference/glue.html">glue</a></span>(<span class="st">"{Cerebro.options$cerebro_root}/shiny/v1.3/shiny_UI.R"</span>))
<span class="fu"><a href="https://rdrr.io/r/base/source.html">source</a></span>(<span class="kw pkg">glue</span><span class="kw ns">::</span><span class="fu"><a href="https://glue.tidyverse.org/reference/glue.html">glue</a></span>(<span class="st">"{Cerebro.options$cerebro_root}/shiny/v1.3/shiny_server.R"</span>))

<span class="co">## launch app ----------------------------------------------------------------##</span>
<span class="kw pkg">shiny</span><span class="kw ns">::</span><span class="fu"><a href="https://shiny.rstudio.com/reference/shiny/latest/shinyApp.html">shinyApp</a></span>(
  <span class="kw">ui</span> <span class="kw">=</span> <span class="no">ui</span>,
  <span class="kw">server</span> <span class="kw">=</span> <span class="no">server</span>,
  <span class="kw">options</span> <span class="kw">=</span> <span class="no">shiny_options</span>
)</pre></body></html></div>
</div>
<div id="deploy-app" class="section level1">
<h1 class="hasAnchor">
<a href="#deploy-app" class="anchor"></a>Deploy app</h1>
<p>Now, it is time to upload the app the shinyapps.io. With <code>rsconnect</code>, that can be quickly done using the code below.</p>
<p>Since we have a dependency from <a href="http://bioconductor.org">Bioconductor</a>, we have to add the current release (3.11) to the repositories using the <code><a href="https://rdrr.io/r/utils/setRepositories.html">setRepositories()</a></code> command. When doing so, you will be asked which repositories should be used in this session. For what we are doing here, selecting <code>CRAN</code> and <code>BioC software</code> should be sufficient.</p>
<p>When you run the <code><a href="https://rdrr.io/pkg/rsconnect/man/deployApp.html">deployApp()</a></code> command, you might receive a warning about a hidden <code><a href="https://rdrr.io/r/base/browser.html">browser()</a></code> call in the <code>shiny/v1.3/about/server.R</code> file, but you can ignore that and proceed. Alternatively, you can simply comment out the respective line.</p>
<div class="sourceCode" id="cb5"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/utils/setRepositories.html">setRepositories</a></span>(<span class="kw">addURLs</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="kw">BioC</span> <span class="kw">=</span> <span class="st">"https://bioconductor.org/packages/3.11/bioc"</span>))

<span class="kw pkg">rsconnect</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/rsconnect/man/deployApp.html">deployApp</a></span>(<span class="st">'~/test_cerebro_shinyapps/'</span>, <span class="kw">appName</span> <span class="kw">=</span> <span class="st">'Cerebro'</span>)</pre></body></html></div>
<p>Uploading and preparing the app might take a few minutes, but once it finishes successfully, Cerebro should open in your browser. Using the shinyapps.io dashboard, you can manage the app, check usage metrics and logs, etc. An important parameter is the “Instance size”, which controls the available memory and can be controled in the “Settings” tab of the dashboard. The larger the data set you want to upload to Cerebro, the more memory will be necessary.</p>
</div>
<div id="see-also" class="section level1">
<h1 class="hasAnchor">
<a href="#see-also" class="anchor"></a>See also</h1>
<ul>
<li><a href="launch_cerebro_with_pre-loaded_data_set.html">Launch Cerebro with pre-loaded data set</a></li>
<li><a href="control_access_to_cerebro_with_a_login_page.html">Control access to Cerebro with a login page</a></li>
</ul>
</div>
<div id="known-issues" class="section level1">
<h1 class="hasAnchor">
<a href="#known-issues" class="anchor"></a>Known issues</h1>
<ul>
<li>Exporting plots to PDF through the <code>export to PDF</code> buttons effectively does not work at the moment. That is because it will trigger a file selection dialog on the server side, not allowing the user to specify a location on their local machine.</li>
</ul>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Roman Hillje.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
